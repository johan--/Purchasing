-if permitted_to? :update, :line_items
  .line_number
    =hb 'lineNumber'
  =hb 'view App.DescriptionInputView value=description class="description_field"'
  =hb 'input value=unit class="unit_field"'
  =hb 'input value=quantity class="quantity_field"'

  %span{ bind: { class: ':total_received overQuantity' },  title: 'Total number of item(s) received.<br />Green = Complete<br />Yellow = Partial<br />Red = More received than ordered' }
    =hb 'receivedCount'

  =hb 'if isReceiving' do
    =hb 'view App.ReceivingArrowView direction=-1'
    .received_input
      =hb 'curReceivedCount'
    =hb 'view App.ReceivingArrowView direction=1'

    =hb 'else'

    .cur_received
      =hb 'if isHighlighted' do
        =hb 'curReceivedHoverCount'
    =hb 'view App.PriceInput value=price class="price_field"'
    .extended_field
      =hb 'currency extendedCost'

  -if permitted_to? :delete, :line_items
    .delete{ _action: 'deleteMe target="view"', title: 'Delete line item' }
      =fa_icon 'times'

-else
  .line_number
    =hb 'lineNumber'
  .description_field=hb 'description'
  .unit_field=hb 'unit'
  .quantity_field=hb 'quantity'
  %div{ bind: { class: 'isHighlighted:hidden:received_count' }, title: '' }
    =hb 'twoCountsField'
  %div{ bind: { class: 'isHighlighted:received_count:hidden' } }
    =hb 'threeCountsField'
  .price_field=hb 'currency price'
  .extended_field
    =hb 'currency extendedCost'
