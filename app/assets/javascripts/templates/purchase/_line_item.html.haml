-if permitted_to? :update, :line_items
  %td.line_number
    =hb 'lineNumber'
  %td.description=hb 'view App.DescriptionInputView value=description'
  %td.unit=hb 'input value=unit'
  %td.quantity=hb 'input value=quantity class="center"'

  %td{ bind: { class: ':received_count overQuantity' },  title: 'Total number of item(s) received.<br />Green = Complete<br />Yellow = Partial<br />Red = More received than ordered' }
    =hb 'receivedCount'

  =hb 'if isReceiving' do
    %td.is_receiving_container
      =hb 'view App.ReceivingArrowView direction=-1'
      %span=hb 'curReceivedCount'
      =hb 'view App.ReceivingArrowView direction=1'

    =hb 'else'

    %td.received_count
      =hb 'if isHighlighted' do
        =hb 'curReceivedHoverCount'
    %td.price=hb 'view App.PriceInput value=price class="right"'

  %td.price=hb 'currency extendedCost'

  -if permitted_to? :delete, :line_items
    %td.delete_container
      .delete{ _action: 'deleteMe target="view"', title: 'Delete line item' }
        =fa_icon 'times'

-else
  %td.line_number
    =hb 'lineNumber'
  %td.description=hb 'description'
  %td.unit=hb 'unit'
  %td.quantity=hb 'quantity'
  %td{ bind: { class: 'isHighlighted:hidden:received_count' }, title: '' }
    =hb 'twoCountsField'
  %td{ bind: { class: 'isHighlighted:received_count:hidden' } }
    =hb 'threeCountsField'
  %td.price=hb 'currency price'
  %td.price
    =hb 'currency extendedCost'
